<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mermaid Word Game</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, #87CEEB, #1E90FF);
    }
    #game {
      position: relative;
      width: 100vw;
      height: 100vh;
    }
    #mermaid {
      position: absolute;
      width: 50px;
      height: 50px;
      background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTI1IDBDMTEuMiAwIDAgMTEuMiAwIDI1czExLjIgMjUgMjUgMjUgMjUtMTEuMiAyNS0yNVszOC44IDAgMjUgMHptMCA0OGMtMTIuNyAwLTIzLTEwLjMtMjMtMjNTMTIuMyAyIDI1IDJzMjMgMTAuMyAyMyAyMy0xMC4zIDIzLTIzIDIzem0tMTItMTVjLTEuNyAwLTMtMS4zLTMtM3MxLjMtMyAzLTMgMyAxLjMgMyAzLTEuMyAzLTMgM3ptMjQgMGMtMS43IDAtMy0xLjMtMy0zczEuMy0zIDMtMyAzIDEuMyAzIDMtMS4zIDMtMyAzem0tMTItMTJjLTEuNyAwLTMtMS4zLTMtM3MxLjMtMyAzLTMgMyAxLjMgMyAzLTEuMyAzLTMgM3oiIGZpbGw9IiNmZmYiLz48L3N2Zz4=');
      background-size: cover;
      z-index: 2;
    }
    .letter-tile {
      position: absolute;
      width: 40px;
      height: 40px;
      background-color: rgba(255, 255, 255, 0.8);
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      color: #000;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      z-index: 1;
    }
    .frog {
      position: absolute;
      width: 40px;
      height: 40px;
      background-color: green;
      border-radius: 50%;
      z-index: 1;
    }
    .ripple {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 2px solid rgba(173, 216, 230, 0.8);
      animation: ripple-effect 1s ease-out;
      z-index: 0;
    }
    @keyframes ripple-effect {
      0% {
        transform: scale(0);
        opacity: 1;
      }
      100% {
        transform: scale(2);
        opacity: 0;
      }
    }
    #word {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 5px;
      z-index: 3;
    }
    .word-tile {
      width: 40px;
      height: 40px;
      background-color: rgba(255, 255, 255, 0.8);
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      color: #000;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    #score {
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 24px;
      color: #fff;
      text-shadow: 1px 1px 2px #000;
    }
  </style>
</head>
<body>
  <div id="game">
    <div id="mermaid"></div>
    <div id="word"></div>
    <div id="score">Score: 0</div>
  </div>

  <script>
    const game = document.getElementById('game');
    const mermaid = document.getElementById('mermaid');
    const wordDisplay = document.getElementById('word');
    const scoreDisplay = document.getElementById('score');
    let word = '';
    let letters = [];
    let frogs = [];
    let wordList = [];
    let score = 0;

    // Load word list (using a placeholder list for now)
    wordList = ['apple', 'banana', 'cherry', 'date', 'elderberry', 'fig', 'grape'];
    wordList = wordList.filter(w => w.length > 1); // Ignore one-letter words

    // Mermaid position
    let mermaidX = window.innerWidth / 2;
    let mermaidY = window.innerHeight / 2;
    mermaid.style.left = `${mermaidX}px`;
    mermaid.style.top = `${mermaidY}px`;

    // Touch controls
    let touchX = 0, touchY = 0;
    game.addEventListener('touchstart', (e) => {
      touchX = e.touches[0].clientX;
      touchY = e.touches[0].clientY;
    });
    game.addEventListener('touchmove', (e) => {
      e.preventDefault();
      const deltaX = e.touches[0].clientX - touchX;
      const deltaY = e.touches[0].clientY - touchY;
      mermaidX = Math.max(0, Math.min(window.innerWidth - 50, mermaidX + deltaX));
      mermaidY = Math.max(0, Math.min(window.innerHeight - 50, mermaidY + deltaY));
      mermaid.style.left = `${mermaidX}px`;
      mermaid.style.top = `${mermaidY}px`;
      touchX = e.touches[0].clientX;
      touchY = e.touches[0].clientY;
    });

    // Generate random letters
    function generateLetter() {
      const letterTile = document.createElement('div');
      letterTile.className = 'letter-tile';
      const letter = String.fromCharCode(65 + Math.floor(Math.random() * 26));
      letterTile.innerText = letter;
      const x = Math.random() * (window.innerWidth - 50);
      const y = -50;
      letterTile.style.left = `${x}px`;
      letterTile.style.top = `${y}px`;
      game.appendChild(letterTile);

      // Track whether the letter has been collected
      let collected = false;

      // Move letter downward
      const interval = setInterval(() => {
        const currentY = parseFloat(letterTile.style.top);
        if (currentY > window.innerHeight) {
          clearInterval(interval);
          game.removeChild(letterTile);
          letters = letters.filter(l => l.element !== letterTile);
        } else {
          letterTile.style.top = `${currentY + 2}px`;
        }

        // Check collision with mermaid
        if (
          !collected &&
          currentY >= mermaidY &&
          currentY <= mermaidY + 50 &&
          x >= mermaidX &&
          x <= mermaidX + 50
        ) {
          word += letter.toLowerCase();
          wordDisplay.appendChild(createWordTile(letter));
          collected = true; // Mark the letter as collected

          // Add ripple effect
          const ripple = document.createElement('div');
          ripple.className = 'ripple';
          ripple.style.left = `${x - 10}px`;
          ripple.style.top = `${currentY - 10}px`;
          game.appendChild(ripple);
          setTimeout(() => game.removeChild(ripple), 1000);

          // Remove the letter tile after a short delay
          setTimeout(() => {
            game.removeChild(letterTile);
            letters = letters.filter(l => l.element !== letterTile);
          }, 100);

          checkWord();
        }
      }, 20);
    }

    // Create a word tile for the bottom display
    function createWordTile(letter) {
      const tile = document.createElement('div');
      tile.className = 'word-tile';
      tile.innerText = letter;
      return tile;
    }

    // Generate frog
    function generateFrog() {
      const frog = document.createElement('div');
      frog.className = 'frog';
      const x = Math.random() * (window.innerWidth - 40);
      const y = -40;
      frog.style.left = `${x}px`;
      frog.style.top = `${y}px`;
      game.appendChild(frog);

      // Move frog downward
      const interval = setInterval(() => {
        const currentY = parseFloat(frog.style.top);
        if (currentY > window.innerHeight) {
          clearInterval(interval);
          game.removeChild(frog);
          frogs = frogs.filter(f => f.element !== frog);
        } else {
          frog.style.top = `${currentY + 2}px`;
        }

        // Check collision with mermaid
        if (
          currentY >= mermaidY &&
          currentY <= mermaidY + 50 &&
          x >= mermaidX &&
          x <= mermaidX + 50
        ) {
          word = '';
          wordDisplay.innerHTML = '';
          game.removeChild(frog);
          clearInterval(interval);
        }
      }, 20);
    }

    // Check if word is valid
    function checkWord() {
      if (wordList.includes(word)) {
        celebrateWord();
      }
    }

    // Celebrate successful word
    function celebrateWord() {
      // Create stars for each letter
      const stars = [];
      for (let i = 0; i < word.length; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = `${window.innerWidth / 2 + (i - word.length / 2) * 30}px`;
        star.style.top = `${window.innerHeight - 100}px`;
        game.appendChild(star);
        stars.push(star);
      }

      // Animate stars exploding and flying to the top-left corner
      stars.forEach((star, index) => {
        setTimeout(() => {
          const targetX = 10;
          const targetY = 10 + index * 10;
          const duration = 1000;

          star.animate(
            [
              { transform: 'scale(1)', opacity: 1 },
              { transform: 'scale(2)', opacity: 0.5, offset: 0.5 },
              { transform: `translate(${targetX}px, ${targetY}px) scale(0.5)`, opacity: 0 }
            ],
            { duration, easing: 'ease-out' }
          ).onfinish = () => {
            game.removeChild(star);
            score++;
            scoreDisplay.innerText = `Score: ${score}`;
          };
        }, index * 100);
      });

      // Reset word
      word = '';
      wordDisplay.innerHTML = '';
    }

    // Generate letters every 2 seconds
    setInterval(generateLetter, 2000);

    // Generate frog every 5 seconds
    setInterval(generateFrog, 5000);
  </script>
</body>
</html>